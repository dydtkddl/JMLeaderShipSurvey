import{r as c,j as e,W as x}from"./index-4a9b11af.js";import{a as j}from"./axios-9cbf0d09.js";import{f as n}from"./Button-74cf8862.js";import{T as y}from"./Typography-0a9a6e09.js";const g=()=>{const[i,h]=c.useState([]),[l,m]=c.useState(null),r=localStorage.getItem("admin");console.log(r),c.useEffect(()=>{(async()=>{try{const t={surveyname:"JMLeadershipEvaluationSurvey"},a={"Content-Type":"application/json"},o=await j.post("https://jmleadership.pythonanywhere.com/api/AdminUserList/",t,{headers:a});h(o.data),console.log(o.data)}catch(t){console.error("Error fetching user data:",t)}})()},[r]);const p=async()=>{try{const s=await fetch("https://jmleadership.pythonanywhere.com/export_survey_responses/",{method:"GET",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(s.ok){console.log("success");const t=await s.blob(),a=window.URL.createObjectURL(t),o=document.createElement("a");o.href=a,o.download="survey_results.xlsx",document.body.appendChild(o),o.click(),o.remove()}else console.error("Failed to download results")}catch(s){console.error("Error downloading results:",s)}},u=()=>{localStorage.removeItem("admin"),window.location.href="/signin"},d=s=>{m(s)};return e.jsx("div",{className:"admin-dashboard",children:i.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"sidebar",children:[e.jsx(n,{variant:"contained",onClick:u,sx:{marginRight:1},children:"Logout"}),e.jsx(n,{variant:"contained",color:"primary",onClick:p,children:"Download Results"}),e.jsx(y,{variant:"h6",style:{flexGrow:1},children:"Hi Admin!"}),i.map(s=>e.jsxs("div",{className:"user-item",children:[e.jsx("h3",{children:s.name}),e.jsx("p",{children:s.email}),s.access_token==="Not Yet"?e.jsx(n,{onClick:()=>d(s.access_token),children:"Not Yet"}):e.jsx(n,{onClick:()=>d(s.access_token),children:"View Survey"})]},s.id))]}),e.jsx("div",{className:"content",children:l?e.jsx("iframe",{src:`https://jmleadership.pythonanywhere.com/view_report/?token=${l}`,title:"Survey Result",width:"100%",height:"100%"}):e.jsx("p",{children:"Select a user to view their survey results"})})]}):e.jsx("p",{children:"Loading user data..."})})},w=g;function S(){return e.jsxs(e.Fragment,{children:[e.jsx(x,{children:e.jsx("title",{children:" admin dashboard"})}),e.jsx(w,{})]})}export{S as default};
