import{r as a,j as e,W as x}from"./index-a42fac35.js";import{a as j}from"./axios-9cbf0d09.js";import{f as i}from"./Button-e684f2b7.js";import{T as g}from"./Typography-e8e340d9.js";const v=()=>{const[c,d]=a.useState([]),[l,h]=a.useState(null),r=localStorage.getItem("admin");console.log(r),a.useEffect(()=>{(async()=>{try{const t={surveyname:"JMLeadershipEvaluationSurvey"},n={"Content-Type":"application/json"},o=await j.post("http://127.0.0.1:8000/api/AdminUserList/",t,{headers:n});d(o.data),console.log(o.data)}catch(t){console.error("Error fetching user data:",t)}})()},[r]);const m=async()=>{try{const s=await fetch("http://127.0.0.1:8000/export_survey_responses/",{method:"GET",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(s.ok){console.log("success");const t=await s.blob(),n=window.URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download="survey_results.xlsx",document.body.appendChild(o),o.click(),o.remove()}else console.error("Failed to download results")}catch(s){console.error("Error downloading results:",s)}},p=()=>{localStorage.removeItem("admin"),window.location.href="/signin"},u=s=>{h(s)};return e.jsx("div",{className:"admin-dashboard",children:c.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"sidebar",children:[e.jsx(i,{variant:"contained",onClick:p,sx:{marginRight:1},children:"Logout"}),e.jsx(i,{variant:"contained",color:"primary",onClick:m,children:"Download Results"}),e.jsx(g,{variant:"h6",style:{flexGrow:1},children:"Hi Admin!"}),c.map(s=>e.jsxs("div",{className:"user-item",children:[e.jsx("h3",{children:s.name}),e.jsx("p",{children:s.email}),e.jsx(i,{onClick:()=>u(s.access_token),children:"View Survey"})]},s.id))]}),e.jsx("div",{className:"content",children:l?e.jsx("iframe",{src:`http://127.0.0.1:8000/view_report/?token=${l}`,title:"Survey Result",width:"100%",height:"100%"}):e.jsx("p",{children:"Select a user to view their survey results"})})]}):e.jsx("p",{children:"Loading user data..."})})},f=v;function S(){return e.jsxs(e.Fragment,{children:[e.jsx(x,{children:e.jsx("title",{children:" admin dashboard"})}),e.jsx(f,{})]})}export{S as default};
